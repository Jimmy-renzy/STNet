# STNet
网络结构[256,128,32]
[8.5505374e-02 5.2018624e-02 2.7067000e-02 1.1611500e-02 3.8777499e-03 9.7874994e-04 1.7437500e-04 2.1500000e-05 2.4999999e-06 0.0000000e+00]



# 网络在epoch=2^18训练完成

## GatedNet
    高斯噪声
    epoch = 2 ** 18 Time Used:1679.7504518032074s = 27.99584086338679min
    
### test_batch=100 num_words=10000 测试集10000批(100,8)
    ber: [0.0845625 0.0509375 0.026725  0.0113    0.0037875 0.0009125 0.00015 0.        0.        0.      ]
    ber: [8.21625e-02 5.00500e-02 2.64875e-02 1.16875e-02 3.87500e-03 9.12500e-04 1.62500e-04 3.75000e-05 0.00000e+00 0.00000e+00]
    ber: [8.347000e-02 5.018250e-02 2.596625e-02 1.096875e-02 3.660000e-03 9.037500e-04 1.350000e-04 1.500000e-05 2.500000e-06 0.000000e+00]
    
### test_batch=100 num_words=100000 测试集100000批(100,8) 
#### sigmoid  
    [8.411625e-02, 5.081625e-02, 2.652500e-02, 1.137875e-02, 3.855000e-03, 9.325000e-04, 1.800000e-04, 2.625000e-05, 8.750000e-06, 0.000000e+00]
#### hard_sigmoid   相比于 sigmoid 在高信噪比下产生一定的性能提升
    [8.369625e-02, 5.004000e-02, 2.574375e-02, 1.089500e-02, 3.588750e-03, 8.775000e-04, 1.587500e-04, 1.750000e-05, 1.250000e-06, 0.000000e+00]
#### no_bias
    [8.453000e-02, 5.115875e-02, 2.676250e-02, 1.160125e-02, 3.952500e-03, 1.008750e-03, 1.762500e-04, 3.125000e-05, 5.000000e-06, 0.000000e+00]
#### hard_sigmoid & no_bias
    [8.38800e-02, 5.05750e-02, 2.62725e-02, 1.11825e-02, 3.71625e-03, 9.07500e-04, 1.62500e-04, 2.75000e-05, 7.50000e-06, 0.00000e+00]

GatedNet: [8.369625e-02, 5.004000e-02, 2.574375e-02, 1.089500e-02, 3.588750e-03, 8.775000e-04, 1.587500e-04, 1.750000e-05, 1.250000e-06, 0.000000e+00]
GRU:[8.400075e-02 5.073950e-02 2.619575e-02 1.111275e-02 3.691500e-03 9.210000e-04 1.707500e-04 2.450000e-05 2.750000e-06 0.000000e+00]
(sigmoid+tanh)|sigmoid:[8.769475e-02 5.401775e-02 2.875900e-02 1.266125e-02 4.433750e-03 1.144250e-03 2.210000e-04 3.125000e-05 5.750000e-06 7.500000e-07]
sigmoid+tanh: [8.406350e-02, 5.050675e-02, 2.602025e-02, 1.093700e-02, 3.590250e-03, 8.865000e-04, 1.610000e-04, 2.275000e-05, 1.750000e-06, 0.000000e+00]
       
       NN1:   [8.434525e-02, 5.079300e-02, 2.626325e-02, 1.118925e-02, 3.714500e-03, 9.310000e-04, 1.747500e-04, 2.550000e-05, 4.250000e-06, 0.000000e+00]
       NN1:   [8.443400e-02, 5.097600e-02, 2.632325e-02, 1.106550e-02, 3.679500e-03, 9.280000e-04, 1.807500e-04, 2.450000e-05, 2.250000e-06, 0.000000e+00]
              [8.486250e-02, 5.091500e-02, 2.642500e-02, 1.133875e-02, 3.690000e-03, 9.250000e-04, 1.850000e-04, 2.750000e-05, 0.000000e+00 0.000000e+00]
              [8.4192500e-02 5.0788376e-02 2.6236124e-02 1.1144500e-02 3.7011250e-03 9.4587501e-04 1.7550000e-04 2.4249999e-05 2.8750001e-06 0.0000000e+00]
       Time Used:248.26201796531677s = 4.1377002994219465min
  测试集10^6: [9.705500e-02 6.422850e-02 3.843025e-02 2.036450e-02 9.468500e-03 3.774750e-03 1.287375e-03 3.662500e-04 8.437500e-05 1.425000e-05]
       
       
       NN2:   [8.464050e-02, 5.105325e-02, 2.650600e-02, 1.137175e-02, 3.798750e-03, 9.505000e-04, 1.690000e-04, 2.225000e-05, 1.000000e-06, 0.000000e+00]
       NN2:   [8.450475e-02, 5.100100e-02, 2.639025e-02, 1.128225e-02, 3.731750e-03, 9.455000e-04, 1.660000e-04, 2.000000e-05, 2.000000e-06, 0.000000e+00]
  测试集10^6: [8.4608503e-02 5.1185749e-02 2.6509250e-02 1.1265625e-02 3.7467501e-03 9.5025002e-04 1.7124999e-04 2.5625000e-05 1.7500000e-06 0.0000000e+00]
       Time Used:250.59948992729187s = 4.176658165454865minl
             [8.438825e-02 5.093825e-02 2.623350e-02 1.121875e-02 3.765125e-03 9.438750e-04 1.710000e-04 2.575000e-05 2.875000e-06 0.000000e+00]             
             [8.4430002e-02 5.0890625e-02 2.6257874e-02 1.1239875e-02 3.7021250e-03 9.3312497e-04 1.7400000e-04 2.3375000e-05 2.4999999e-06 1.2500000e-07]

NN2没有1-
ber: [8.4456503e-02 5.0888874e-02 2.6360750e-02 1.1146250e-02 3.7182500e-03 9.3287497e-04 1.7625000e-04 2.4125000e-05 4.2500001e-06 0.0000000e+00]
ber2: [8.4562875e-02 5.1025249e-02 2.6371250e-02 1.1191500e-02 3.7776250e-03 9.4962498e-04 1.8487500e-04 2.6125001e-05 4.1250000e-06 0.0000000e+00]
       
    GatedNet: [8.369625e-02, 5.004000e-02, 2.574375e-02, 1.089500e-02, 3.588750e-03, 8.775000e-04, 1.587500e-04, 1.750000e-05, 1.250000e-06, 0.000000e+00]
    GatedNet: [8.368950e-02, 5.033275e-02, 2.584150e-02, 1.097950e-02, 3.691500e-03, 9.505000e-04, 1.762500e-04, 2.750000e-05, 3.000000e-06, 0.000000e+00]
   测试集10^6:[8.4010124e-02 5.0796624e-02 2.6472624e-02 1.1434375e-02 3.9091250e-03 9.9712505e-04 1.9000001e-04 3.1625001e-05 5.8750002e-06 0.0000000e+00]
   Time Used:253.93215155601501s = 4.232202525933584min

## MinGatedNet
    epoch = 2 ** 18 Time Used:1533.202558517456s = 25.553375975290933min
    
### test_batch=100 num_words=10000 测试集10000批(100,8)
    ber: [8.42375e-02, 5.23875e-02, 2.71250e-02, 1.14250e-02, 3.58750e-03, 7.75000e-04, 1.50000e-04, 3.75000e-05 1.25000e-05 0.00000e+00]
    神经元输出的激活函数由tanh换为hard_sigmoid后，译码性能变差。
    ber: [0.0953625 0.0614125 0.0345625 0.01635   0.0063125 0.001875  0.000375 0.000125  0.        0.       ]
    

 




------------------------------------------------------------------------------------------------------------------------

# 网络都是epoch=2^18训练完成的
--------------------------------

## 高斯噪声alpha=2.0   GatedNet vs MinGatedNet vs DNN
### GatedNet
    ber: [8.368950e-02, 5.033275e-02, 2.584150e-02, 1.097950e-02, 3.691500e-03, 9.505000e-04, 1.762500e-04, 2.750000e-05, 3.000000e-06, 0.000000e+00]
    
### MinGatedNet
    bias: [8.449525e-02, 5.089825e-02, 2.629125e-02, 1.113325e-02, 3.771000e-03, 9.255000e-04, 1.792500e-04, 2.975000e-05, 3.250000e-06, 0.000000e+00]
    用MinGatedNet_HardSigmoidNoBias_weights_218_alpha2.0.h5测试结果，没有偏差，甚至比有偏差的还好。
    no_bias: [8.425125e-02 5.066575e-02 2.618475e-02 1.119400e-02 3.724500e-03 9.347500e-04 1.670000e-04 2.000000e-05 2.500000e-06 0.000000e+00]
    
    在GSNR=5下训练：[8.996625e-02 5.498050e-02 2.871925e-02 1.233025e-02 4.172500e-03 1.051250e-03 1.887500e-04 2.750000e-05 4.750000e-06 2.500000e-07]
    
### DNN
    Time Used:1205.3952851295471s = 20.089921418825785min (+_50s)
    ber: [7.898825e-02 5.992000e-02 3.246125e-02 1.496875e-02 3.772250e-03 1.250500e-03 5.000000e-06 1.250000e-06 0.000000e+00 0.000000e+00]
    
### STNN
    Time Used:1472.5392997264862s = 24.542321662108105min
    ber: [8.4166877e-02 5.0705750e-02 2.6175374e-02 1.1031125e-02 3.6975001e-03 9.3837501e-04 1.7162500e-04 2.4875000e-05 2.4999999e-06 0.0000000e+00]

    网络结构[256ST+128ST+32Dense]
    [8.5505374e-02 5.2018624e-02 2.7067000e-02 1.1611500e-02 3.8777499e-03 9.7874994e-04 1.7437500e-04 2.1500000e-05 2.4999999e-06 0.0000000e+00]

如果之前画图在alpha=2.0处和论文中相符合，则不变动了！！！
--------------------------------

## 脉冲噪声alpha=1.8   GatedNet vs MinGatedNet vs DNN

### GatedNet
    Time Used:1816.2189002037048s = 30.27031500339508min
    ber: [0.09454325 0.06284525 0.03817275 0.0211855  0.010915   0.00532275 0.002565   0.00127025 0.00063775 0.00033925]

### MinGatedNet
    Time Used: 1467.9234652519226s = 24.465391087532044min
    ber: [0.094145   0.06237025 0.03777475 0.02093525 0.0107975  0.005274 0.0025245  0.001221   0.00062325 0.0003215 ]

### STNN
    Time Used:1482.0894002914429s = 24.70149000485738min
    ber: [0.09405337 0.06229487 0.0376745  0.02101525 0.010845   0.005315 0.00254775 0.00124912 0.00063375 0.00034563]

### NN2    
    Time Used: 1485.254271030426s = 24.7542378505071min
    [0.09411938 0.062475   0.03785875 0.02106613 0.01093038 0.0053565 0.00258588 0.00126925 0.000646   0.0003515 ]
    
### NN1
    1458.0777959823608s = 24.301296599706014min
    [0.0943385  0.06245987 0.0378355  0.02101913 0.01079888 0.00525188 0.00252812 0.00124388 0.00063413 0.00033537]
    
### DNN
    Time Used:1283.5050942897797s = 21.39175157149633min
    ber: [9.144775e-02 7.244675e-02 4.622500e-02 3.117125e-02 1.746800e-02 8.744500e-03 4.988750e-03 1.277500e-03 3.000000e-05 1.900000e-05]
    
--------------------------------

## 脉冲噪声alpha=1.5   GatedNet vs MinGatedNet vs DNN
### GatedNet
    Time Used:1702.2977120876312s = 28.371628534793853min
    ber: [0.10075825 0.0724935  0.04981625 0.03284075 0.02084225 0.0129115 0.0078335  0.00476375 0.0028975  0.001777  ]
    
### MinGatedNet
    Time Used:1516.451248407364s = 25.274187473456063min
    ber: [0.1013955  0.07311275 0.05035525 0.033157   0.0210195  0.01299525 0.00788975 0.004797   0.0029215  0.00180675]
    
### STNet
    Time Used:1471.4459891319275s = 24.52409981886546min
    ber: [0.10113563 0.072945   0.05016463 0.03299813 0.02097487 0.01300988 0.007952   0.00484262 0.00296275 0.001816  ]
    
### NN2    
    Time Used:1487.3147275447845s = 24.788578792413077min
    ber: [0.10176913 0.073535   0.05070125 0.0334695  0.0212935  0.01319463 0.0080955  0.00494825 0.0030095  0.00187312]
    
### DNN
    Time Used:1236.7383987903595s = 20.612306646505992min
    ber:  [0.1174175, 0.09603525, 0.06494675, 0.042516, 0.0299955, 0.02001075, 0.01375725, 0.006313, 0.00257175, 0.00254]

--------------------------------

## 脉冲噪声alpha=1.2   GatedNet vs MinGatedNet vs DNN
### GatedNet
    Time Used:1705.0684921741486s = 28.417808202902474min
    ber: [0.10827475, 0.08563725, 0.066267, 0.050277, 0.0375245, 0.0278605, 0.02043225, 0.01504825, 0.011007, 0.00806975]

### MinGatedNet
    Time Used:1553.2358095645905s = 25.887263492743173min
    ber: [0.10933725, 0.0864995, 0.066967, 0.050971,  0.03813725, 0.02831125, 0.02081575, 0.0152245, 0.0112, 0.0082645]
    
### STNet
    Time Used:1494.8298892974854s = 24.91383148829142min
    ber: [0.10782138 0.08486525 0.06534825 0.04926462 0.03666525 0.02690075 0.0195005  0.01408712 0.010045   0.00718675]
 
### NN2     
    Time Used:1476.1610474586487s = 24.602684124310812min
    ber: [0.11005638 0.08732212 0.0678755  0.05177375 0.03902275 0.02905525 0.0214975  0.01581225 0.01165625 0.00857088]
    
### DNN
    Time Used:1194.868789434433s = 19.914479823907218min
    ber: [0.1163645  0.101235   0.09473925 0.07482225 0.06352275 0.0498415 0.0398585  0.02378425 0.02122625 0.01623925]
    
------------------------------------------------------------------------------------------------------------------------

# 最小门控网络 
## 推理速度
    GnnDecoder.test(2.0, 0, 7, 8, 100, 500000)
    MinGatedDense Time Used: 98.76841497421265s = 1.6461402495702109min
    GatedDense Time Used: 102.53645825386047s = 1.7089409708976746min
    
    

#基于层敏感度剪枝效果

## 第一层剪枝译码率数据
[8.455625e-02, 5.098625e-02, 2.617125e-02, 1.121250e-02, 3.701250e-03, 9.612500e-04, 1.662500e-04, 2.000000e-05],
[8.522375e-02, 5.141875e-02, 2.657500e-02, 1.141625e-02, 3.792500e-03, 9.687500e-04, 1.625000e-04, 2.625000e-05],
[8.455250e-02, 5.071625e-02, 2.595375e-02, 1.092125e-02, 3.673750e-03, 9.275000e-04, 1.637500e-04, 3.000000e-05],
[8.466500e-02, 5.106875e-02, 2.643125e-02, 1.120125e-02, 3.773750e-03, 9.925000e-04, 1.775000e-04, 1.625000e-05],
[8.497875e-02, 5.140375e-02, 2.643125e-02, 1.140750e-02, 3.757500e-03, 8.900000e-04, 1.637500e-04, 3.250000e-05],
[8.400500e-02, 5.048500e-02, 2.597125e-02, 1.104000e-02, 3.646250e-03, 9.487500e-04, 1.675000e-04, 2.375000e-05],
[8.481375e-02, 5.106750e-02, 2.634625e-02, 1.118250e-02, 3.765000e-03, 9.412500e-04, 1.762500e-04, 2.500000e-05],
[8.672250e-02, 5.298875e-02, 2.765125e-02, 1.196625e-02, 4.028750e-03, 1.073750e-03, 1.800000e-04, 2.250000e-05],
[9.424500e-02, 5.923125e-02, 3.218375e-02, 1.472875e-02, 5.403750e-03, 1.573750e-03, 3.362500e-04, 5.875000e-05],
[0.20257124,   0.15965375,   0.11785625,   0.0811425 ,   0.05215875,   0.03120625,   0.01771   ,   0.00982875]

## 第二层剪枝译码率数据
[8.45725e-02,  5.12000e-02,  2.63475e-02,  1.12175e-02,  3.83250e-03,  1.03250e-03,  2.13750e-04,  1.87500e-05], 
[8.497250e-02, 5.132125e-02, 2.617375e-02, 1.124375e-02, 3.763750e-03, 9.400000e-04, 1.562500e-04, 3.500000e-05],
[8.450125e-02, 5.079875e-02, 2.637750e-02, 1.132000e-02, 3.896250e-03, 1.058750e-03, 1.912500e-04, 2.375000e-05],
[8.537250e-02, 5.184125e-02, 2.678250e-02, 1.153000e-02, 3.875000e-03, 1.097500e-03, 1.937500e-04, 2.625000e-05],
[8.629875e-02, 5.266500e-02, 2.771500e-02, 1.241250e-02, 4.356250e-03, 1.225000e-03, 2.425000e-04, 3.250000e-05],
[8.883875e-02, 5.459000e-02, 2.887250e-02, 1.288250e-02, 4.553750e-03, 1.265000e-03, 2.512500e-04, 3.375000e-05],
[9.46250e-02,  5.96650e-02,  3.28625e-02,  1.54050e-02,  5.93375e-03,  1.77875e-03,  4.11250e-04,  8.00000e-05], 
[0.113825  ,   0.07743375,   0.04712625,   0.02522125,   0.01169   ,   0.004655  ,   0.0015525 ,   0.00051   ], 
[0.188905  ,   0.15326625,   0.1199175 ,   0.09046625,   0.06649625,   0.04778375,   0.034125  ,   0.02422625], 
[0.37925   ,   0.3665175 ,   0.353795  ,   0.34163374,   0.33013624,   0.3200525 ,   0.31136125,   0.3037575 ]

## 第三层剪枝译码率数据
[8.43125e-02,  5.09300e-02,  2.62125e-02,  1.11250e-02,  3.77625e-03,  1.02625e-03,  2.05000e-04,  1.87500e-05], 
[8.354125e-02, 5.051625e-02, 2.598375e-02, 1.121375e-02, 3.743750e-03, 9.850000e-04, 1.962500e-04, 2.625000e-05],
[8.45475e-02,  5.13475e-02,  2.63575e-02,  1.09725e-02,  3.64375e-03,  9.36250e-04,  1.98750e-04,  2.25000e-05], 
[8.471375e-02, 5.143750e-02, 2.646000e-02, 1.127625e-02, 3.707500e-03, 9.587500e-04, 1.700000e-04, 3.000000e-05],
[8.616000e-02, 5.229875e-02, 2.767375e-02, 1.218875e-02, 4.173750e-03, 1.152500e-03, 2.337500e-04, 4.875000e-05],
[8.862625e-02, 5.485250e-02, 2.935625e-02, 1.307625e-02, 4.633750e-03, 1.261250e-03, 2.775000e-04, 3.500000e-05],
[9.342000e-02, 5.903250e-02, 3.253125e-02, 1.506625e-02, 5.687500e-03, 1.638750e-03, 3.962500e-04, 6.125000e-05],
[0.107705  ,   0.07144   ,   0.04271375,   0.022525  ,   0.01042625,   0.004265  ,   0.001555  ,   0.0005725 ], 
[0.15754125,   0.12236375,   0.09094   ,   0.06491375,   0.0451825 ,   0.0315275 ,   0.0228075 ,   0.01742125], 
[0.31193125,   0.29069376,   0.26971   ,   0.2501675 ,   0.23309375,   0.2185775 ,   0.206805  ,   0.19759625]


## 第四层剪枝译码率数据
[8.464750e-02, 5.039375e-02, 2.604750e-02, 1.108375e-02, 3.816250e-03, 1.030000e-03, 1.950000e-04, 2.500000e-05],
[8.49300e-02,  5.16000e-02,  2.69575e-02,  1.16200e-02,  3.96625e-03,  9.80000e-04,  1.73750e-04,  3.25000e-05],
[8.455875e-02, 5.087000e-02, 2.620875e-02, 1.104875e-02, 3.641250e-03, 9.000000e-04, 1.725000e-04, 3.000000e-05],
[8.431875e-02, 5.068375e-02, 2.639125e-02, 1.116125e-02, 3.588750e-03, 9.450000e-04, 1.575000e-04, 2.000000e-05],
[8.527125e-02, 5.141625e-02, 2.646125e-02, 1.115250e-02, 3.615000e-03, 8.887500e-04, 1.637500e-04, 1.500000e-05],
[8.46500e-02,  5.13700e-02,  2.67100e-02,  1.13950e-02,  3.89875e-03,  9.32500e-04,  1.81250e-04,  2.00000e-05], 
[8.566375e-02, 5.217000e-02, 2.703625e-02, 1.150375e-02, 3.947500e-03, 1.003750e-03, 1.787500e-04, 2.125000e-05],
[8.996375e-02, 5.621250e-02, 3.038500e-02, 1.386500e-02, 5.046250e-03, 1.478750e-03, 3.550000e-04, 8.625000e-05],
[0.104875  ,   0.069655  ,   0.04203625,   0.02231   ,   0.01091125,   0.00494375,   0.0025375 ,   0.0016975 ], 
[0.1898175 ,   0.16091375,   0.13733375,   0.12058375,   0.11001875,   0.10415125,   0.10146375,   0.10029125]


# 第一层灵敏度曲线（5%的剪枝率间隔）
ber1_log_6dB = [1.7025e-04, 1.720e-04, 1.850e-04, 1.7675e-04, 1.7575e-04, 1.7625e-04, 1.715e-04, 1.925e-04, 1.8525e-04,
                1.9125e-04, 1.7825e-04, 1.9575e-04, 1.9825e-04, 1.7725e-04, 2.145e-04, 2.4325e-04, 3.1925e-04,
                0.000655, 0.01787425, 0.50153023]

ber1_log_7dB = [2.3500e-05, 2.175e-05, 2.325e-05, 2.5500e-05, 2.1250e-05, 2.5750e-05, 2.300e-05, 2.550e-05, 2.5500e-05,
                3.2750e-05, 2.8750e-05, 2.8500e-05, 2.9250e-05, 2.6250e-05, 3.050e-05, 3.7000e-05, 4.6500e-05,
                0.000125, 0.00978325, 0.4970475]


# 第二层灵敏度曲线（5%的剪枝率间隔）
 GSNR=6dB    GSNR=7dB
[1.6725e-04, 2.0500e-05], 
[1.84e-04,   1.95e-05], 
[1.7625e-04, 2.3750e-05], 
[1.7825e-04, 2.5250e-05], 
[1.7325e-04, 2.3000e-05], 
[1.8225e-04, 2.4000e-05], 
[1.9875e-04, 2.4250e-05], 
[2.07e-04,   2.75e-05], 
[2.045e-04,  3.225e-05], 
[2.060e-04,  2.675e-05], 
[2.5825e-04, 4.2250e-05], 
[3.015e-04,  5.150e-05], 
[4.3625e-04, 6.9750e-05], 
[0.0007615,  0.0001715], 
[0.0016735,  0.000521 ], 
[0.00664325, 0.00325925], 
[0.0342215,  0.0244775], 
[0.132442  , 0.11793125], 
[0.31080574, 0.3033115 ], 
[0.44331774, 0.44088826], 

# 第三层灵敏度曲线（5%的剪枝率间隔）
 GSNR=6dB    GSNR=7dB
[1.8825e-04 2.3250e-05],
[1.650e-04  1.925e-05],
[1.700e-04  2.475e-05],
[1.8425e-04 2.3250e-05],
[1.78e-04   2.85e-05],
[1.82e-04   2.35e-05],
[1.9225e-04 2.6750e-05],
[1.825e-04  2.275e-05],
[2.025e-04  3.200e-05],
[2.2075e-04 3.0500e-05],
[2.48e-04   3.35e-05],
[3.140e-04  4.175e-05],
[3.900e-04  6.325e-05],
[0.000567   0.00011925],
[0.0015435  0.00054  ],
[0.006312   0.00380925],
[0.02286225 0.0173855 ],
[0.0897025  0.08026625],
[0.20693825 0.197709  ],
[0.407683   0.40347126],

# 第四层灵敏度曲线（5%的剪枝率间隔）
ber4_log_6dB = [1.8e-04, 1.8125e-04, 1.755e-04, 1.69e-04, 1.680e-04, 1.7875e-04, 1.815e-04, 1.9275e-04, 1.7275e-04,
                1.8825e-04, 1.8325e-04, 1.9425e-04, 2.080e-04, 2.160e-04, 3.3225e-04, 0.00057725, 0.00252875, 
                0.02619425, 0.10094975, 0.29387]

ber4_log_7dB = [2.7e-05, 2.5500e-05, 2.475e-05, 2.60e-05, 2.575e-05, 2.8250e-05, 2.475e-05, 2.5750e-05, 2.1500e-05,
                2.5250e-05, 2.4250e-05, 3.1250e-05, 2.925e-05, 3.325e-05, 6.4000e-05, 0.00012975, 0.0017215, 0.0250465,
                0.09970475, 0.2929265]
                
                
------------------------------------------------------------------------------------------------------------------------


            
        
        
        
------------------------------------------------------------------------------------------------------------------------
    
# 网络都是epoch=2^16训练完成的

## 高斯噪声alpha=2.0   GatedNet vs MinGatedNet vs DNN
### GatedNet
    loss：0.1494
    Time Used:460.5311255455017s = 7.675518759091696min
    实测数据: [8.70250e-02, 5.34250e-02, 2.85875e-02, 1.30875e-02, 4.63750e-03, 1.18750e-03, 2.50000e-04, 3.75000e-05, 0.00000e+00, 0.00000e+00]
    test画图：[8.70250e-02, 5.34250e-02, 2.85875e-02, 1.30875e-02, 4.63750e-03, 1.18750e-03, 2.50000e-04, 3.75000e-05, 5.0021e-6] 
    
    
### MinGatedNet
    loss: 0.1380
    Time Used:406.1003186702728s = 6.7683386445045475min
    ber: [8.46375e-02, 5.19250e-02, 2.77875e-02, 1.31625e-02, 4.48750e-03, 1.01250e-03, 2.12500e-04, 3.75000e-05, 0.00000e+00 0.00000e+00]

### DNN
    [9.52125e-02 6.18125e-02 3.60000e-02 1.75000e-02 7.01250e-03 2.05000e-03 6.62500e-04 7.50000e-05 1.25000e-05 0.00000e+00]   


## 脉冲噪声alpha=1.8   GatedNet vs MinGatedNet vs DNN

### GatedNet
    loss: 0.1618
    Time Used:473.23862075805664s = 7.88731034596761min
    GN-α1.8: [0.0976875, 0.06685,  0.04215,  0.0243125, 0.01325, 0.0069375, 0.003575, 0.0017125, 0.000875, 0.000525 ]

### MinGatedNet
    loss: 0.1687
    Time Used:410.87491750717163s = 6.847915291786194min
    ber: [0.0974625, 0.0653875, 0.0406375, 0.0233625, 0.0125, 0.0068625, 0.0035, 0.0017625, 0.000925,  0.0004625]

### DNN
    Time Used:308.69524693489075s = 5.144920782248179min
    ber: [0.1102875, 0.078325,  0.052575,  0.0332375, 0.0201625, 0.0119625, 0.0073375, 0.0044625, 0.0027375, 0.0019625]
    

## 脉冲噪声alpha=1.5   GatedNet vs MinGatedNet vs DNN
### GatedNet
    loss: 0.1837
    Time Used:471.48881220817566s = 7.858146870136261min
    GN-α1.5: [0.1058375, 0.0795375, 0.0569875, 0.0389875, 0.0257875, 0.0169875, 0.0112375, 0.0070125, 0.0043625, 0.00265]
    
### MinGatedNet
    Time Used:391.0887043476105s = 6.518145072460174min
    ber: [0.1077125, 0.0799375, 0.0566125, 0.0379625, 0.0253375, 0.015775, 0.010025, 0.00625, 0.00365, 0.002375]
    
### DNN
    Time Used:314.091424703598s = 5.234857078393301min
    ber: [0.1263875 0.1004625 0.0766625 0.0575    0.042325  0.03075   0.0224125 0.016725  0.0123    0.009    ]


## 脉冲噪声alpha=1.2   GatedNet vs MinGatedNet vs DNN
### GatedNet
    Time Used:441.9747109413147s = 7.366245182355245min
    GN-α1.2: [0.1174375, 0.0958625, 0.076925, 0.0611875, 0.0464625, 0.0354, 0.02735, 0.020575, 0.01595, 0.012375]

### MinGatedNet
    Time Used:395.5027847290039s = 6.591713078816732min
    ber: [0.1176625, 0.0941, 0.074575, 0.0582625, 0.044875, 0.0345, 0.02645, 0.019925, 0.0152375, 0.011475]

### DNN
    Time Used:327.98740673065186s = 5.466456778844198min
    ber: [0.141625, 0.1211, 0.1027875, 0.0871125, 0.07375, 0.061525, 0.05155, 0.0429625, 0.03555, 0.0294]
    
    
   
# LSTM 
LSTM 2.0 2^16 [0.16762374 0.14069375 0.11503875 0.09121625 0.07039625 0.05261875 0.03886375 0.0289525  0.02248625 0.0185675]
Time Used:7167.98205447197s = 119.46636757453282min
[0.16223125 0.1344625  0.10766    0.0826575  0.06053375 0.04185125 0.02699375 0.01601    0.00878375 0.00434125]

    alpah=2.0: [9.70650e-02 6.04175e-02 3.19575e-02 1.45000e-02 4.94000e-03 1.22250e-03 2.52500e-04 3.00000e-05 5.00000e-06]
    alpah=1.8: [9.73525e-02 6.41650e-02 3.92625e-02 2.14550e-02 1.10350e-02 4.75500e-03 1.89250e-03 9.57500e-04 4.00000e-04]
    alpah=1.5: [1.01870e-01 7.26675e-02 5.03575e-02 3.32450e-02 2.09400e-02 1.27875e-02 7.78500e-03 4.59000e-03 2.71250e-03]
    alpah=1.2: [1.06410e-01 8.31650e-02 6.31750e-02 4.69925e-02 3.44675e-02 2.53325e-02 1.77425e-02 1.29550e-02 8.60250e-03]


# 瑞利噪声
    测试样例100000
    Time Used:1761.6188201904297s = 29.360313669840494min
    [3.0875e-04 4.8750e-05 1.0000e-05 1.2500e-06 1.2500e-06 2.5000e-06 2.5000e-06 1.0000e-05 3.0000e-05]
    
    测试样例1000000
    Time Used:525.9880774021149s = 8.766467956701915min
    ber: [3.2625e-04 4.2125e-05 5.2500e-06 7.5000e-07 2.0000e-06 3.5000e-06 5.0000e-06 1.3000e-05 3.4500e-05]
    
    测试样例10000000
    Time Used:7450.066152334213s = 124.16776920557022min
    [3.150625e-04 4.213750e-05 6.175000e-06 1.437500e-06 1.675000e-06 2.437500e-06 5.175000e-06 1.263750e-05 3.016250e-05]
    
    [3.150625e-04 4.213750e-05 6.175000e-06 1.437500e-06 7.5000e-07]
    
    
# 剪枝
## AWGN ber_threshold 1.3 1.5
### retrain epochs 2^10

    0.2dB损失
    pruning_rate [84, 54, 49, 68]
    ber:[8.436000e-02 5.112625e-02 2.654500e-02 1.129125e-02 3.687500e-03 8.875000e-04 1.637500e-04 2.000000e-05]
    ber_pruned:[8.877375e-02 5.462375e-02 2.901000e-02 1.286875e-02 4.530000e-03 1.192500e-03 2.350000e-04 3.125000e-05]
    
    10e-3 0.1dB损失  10e-4 0.14dB损失
    pruning_rate [79, 37, 52, 72]
    [8.445250e-02 5.103750e-02 2.611250e-02 1.110625e-02 3.717500e-03 9.600000e-04 1.875000e-04 3.000000e-05]
    [8.878125e-02 5.439875e-02 2.862000e-02 1.256500e-02 4.337500e-03 1.177500e-03 2.312500e-04 4.000000e-05]

    image001
    10e-3 几乎无损失  10e-4 0.1dB损失
    pruning_rate [82, 57, 45, 64]
    [8.479000e-02 5.104250e-02 2.633125e-02 1.122750e-02 3.751250e-03 9.262500e-04 1.612500e-04 2.500000e-05]
    [8.799875e-02 5.400750e-02 2.836250e-02 1.240250e-02 4.176250e-03 1.103750e-03 1.912500e-04 2.750000e-05]
    
### retrain epochs 2^12  
    10e-3 几乎无损失  10e-4 0.09dB损失
    pruning_rate [62, 60, 9, 10]
    [8.478500e-02 5.135875e-02 2.671250e-02 1.140125e-02 3.807500e-03 1.006250e-03 1.875000e-04 2.875000e-05]
    [8.652875e-02 5.243750e-02 2.716625e-02 1.174875e-02 4.012500e-03 9.800000e-04 1.625000e-04 2.250000e-05]  
    
    

    
    
## 脉冲噪声
    10e-2 0.1dB损失
    pruning_rate [95, 26, 28, 74]
    [0.10177875 0.07376625 0.05071125 0.03346125 0.02126125 0.01316125 0.0080125  0.004885   0.00295   ]
    [0.10365125 0.07550625 0.052605   0.03505    0.0226475  0.0142425  0.00869125 0.005315   0.0033    ]]
    
    10e-2 0.2dB损失
    pruning_rate [95, 68, 44, 74]
    [0.10145875 0.07306375 0.05002875 0.03313625 0.02107875 0.013165 0.00804875 0.00498    0.00312625]
    [0.10425    0.07627625 0.053435   0.0361025  0.02357    0.0148475 0.00913    0.00569375 0.0035175 ]
        
    image004
    0.2dB_[95, 57, 32, 74]_retrain211
    pruning_rate [95, 57, 32, 74]
    [0.10131125 0.07345625 0.050625   0.033465   0.02140375 0.01315625 0.0080025  0.004865   0.003     ]
    [0.10430625 0.0763675  0.05306125 0.035665   0.022945   0.0144175 0.00891375 0.00541375 0.00335625]
    
    
## 论文选取的结果
### AWGN
#### Multi-layer sensitivity adaptive pruning  [82, 57, 45, 64]
    image001
    10e-3 几乎无损失  10e-4 0.1dB损失
    pruning_rate [82, 57, 45, 64]
    [8.479000e-02 5.104250e-02 2.633125e-02 1.122750e-02 3.751250e-03 9.262500e-04 1.612500e-04 2.500000e-05]
    [8.799875e-02 5.400750e-02 2.836250e-02 1.240250e-02 4.176250e-03 1.103750e-03 1.912500e-04 2.750000e-05]  
    
    9.969*0.82 + 79.751*0.57 + 9.969*0.45 + 0.311*0.64 = 58.318
#### Simple Pruning
    [9.27487463e-02 5.80100007e-02 3.17324996e-02 1.44087505e-02 5.34124998e-03 1.64749997e-03 3.73749994e-04 5.87499999e-05 7.49999981e-06]   
    [9.27487463e-02, 5.80100007e-02, 3.17324996e-02, 1.44087505e-02, 5.34124998e-03, 1.64749997e-03, 3.73749994e-04, 6.499999e-05, 9.49999981e-06]

### Implusive 
    image004
    0.2dB_[95, 57, 32, 74]_retrain211
    [0.10131125 0.07345625 0.050625   0.033465   0.02140375 0.01315625 0.0080025  0.004865   0.003    ]
    [0.10430625 0.0763675  0.05306125 0.035665   0.022945   0.0144175 0.00891375 0.00541375 0.00335625]    
    
    9.969*0.95 + 79.751*0.57 + 9.969*0.32 + 0.311*0.74 = 58.349
    
    
